---
id: var-risk-metrics
title: VaR & 리스크 지표
sidebar_label: VaR & 리스크 지표
description: VaR, CVaR, 최대낙폭, 변동성 등 핵심 리스크 측정 지표의 수학적 원리와 실전 활용법을 체계적으로 학습합니다
keywords: [VaR, Value at Risk, CVaR, Expected Shortfall, 최대낙폭, MDD, 변동성, 베타, 추적오차, 리스크 지표]
---

# VaR & 리스크 지표

## 학습 목표

- VaR(Value at Risk)의 3가지 산출 방법론을 수학적으로 이해하고 직접 계산할 수 있다
- CVaR(Conditional VaR)이 VaR보다 우월한 리스크 측도인 이유를 설명할 수 있다
- Maximum Drawdown의 계산과 해석, 실전 활용법을 습득한다
- 다양한 변동성 측정 방법(역사적, 내재, EWMA, GARCH)을 비교할 수 있다
- 베타, 추적오차 등 상대적 리스크 지표의 의미와 활용법을 학습한다
- 각 리스크 지표의 장단점을 파악하고 상황에 맞게 선택할 수 있다

---

## VaR (Value at Risk) 심화

### VaR의 정의와 수학적 표현

VaR는 주어진 신뢰수준(confidence level)에서 특정 보유 기간(holding period) 동안 발생할 수 있는 최대 예상 손실입니다.

수학적으로, 신뢰수준 $\alpha$에서의 VaR는 다음을 만족하는 값입니다:

$$P(L > \text{VaR}_\alpha) = 1 - \alpha$$

여기서 $L$은 손실 금액입니다. 즉, 95% VaR가 500만 원이라면 "95% 확률로 손실이 500만 원을 초과하지 않는다"는 의미입니다. 역으로 말하면, 5% 확률로 500만 원 이상의 손실이 발생할 수 있습니다.

:::info VaR의 3가지 핵심 파라미터
1. **신뢰수준**: 일반적으로 95% 또는 99% (바젤 규제에서는 99%)
2. **보유 기간**: 1일, 10일, 1개월 등 (바젤 규제에서는 10일)
3. **포트폴리오 가치**: VaR를 금액으로 환산하기 위한 기준
:::

### 방법론 1: 역사적 시뮬레이션 (Historical Simulation)

과거 실제 수익률 데이터를 그대로 사용하여 VaR를 산출하는 비모수적(non-parametric) 방법입니다.

**산출 절차**:

1. 과거 $N$일(통상 250~500일)의 일일 수익률 $r_1, r_2, \ldots, r_N$을 수집합니다
2. 수익률을 오름차순으로 정렬합니다: $r_{(1)} \leq r_{(2)} \leq \ldots \leq r_{(N)}$
3. 신뢰수준 $\alpha$에 대해 $k = \lfloor N \times (1 - \alpha) \rfloor$ 번째 수익률이 VaR입니다
4. 금액 VaR = 포트폴리오 가치 $\times |r_{(k)}|$

**실전 계산 예시**:

포트폴리오 1억 원, 과거 500일 수익률 데이터 보유, 95% 신뢰수준

- $k = 500 \times 0.05 = 25$
- 하위 25번째 수익률이 $-2.8\%$라면
- 1일 95% VaR = 1억 $\times$ 2.8% = **280만 원**

| 순위 | 수익률 | 비고 |
|:-----|:-------|:-----|
| 1위 (최악) | -7.2% | 극단적 사건 |
| 5위 | -4.5% | 99% VaR 근처 |
| 10위 | -3.6% | 98% VaR 근처 |
| 25위 | -2.8% | **95% VaR** |
| 50위 | -2.1% | 90% VaR 근처 |

**가중 역사적 시뮬레이션 (Weighted Historical Simulation)**:

기본 역사적 시뮬레이션은 모든 과거 데이터에 동일한 가중치를 부여합니다. 그러나 최근 데이터가 미래를 더 잘 예측한다는 관점에서, 최근 데이터에 높은 가중치를 부여하는 방법이 있습니다.

$$w_i = \frac{\lambda^{N-i}}{\sum_{j=1}^{N} \lambda^{N-j}}$$

여기서 $\lambda$는 감쇠 계수(decay factor)로 보통 0.94~0.99를 사용합니다.

### 방법론 2: 파라메트릭 VaR (분산-공분산 방법)

수익률이 정규분포를 따른다는 가정하에, 평균과 표준편차로 VaR를 해석적으로 계산합니다.

**단일 자산 VaR**:

$$\text{VaR}_\alpha = W \times (z_\alpha \times \sigma - \mu) \times \sqrt{T}$$

여기서 $W$는 포트폴리오 가치, $z_\alpha$는 표준정규분포의 분위수, $\sigma$는 일일 표준편차, $\mu$는 일일 평균 수익률, $T$는 보유 기간(일)입니다.

| 신뢰수준 | $z_\alpha$ 값 |
|:---------|:-------------|
| 90% | 1.282 |
| 95% | 1.645 |
| 97.5% | 1.960 |
| 99% | 2.326 |
| 99.5% | 2.576 |
| 99.9% | 3.090 |

실무에서 일일 기대수익률 $\mu$는 매우 작으므로 종종 0으로 가정하여 다음과 같이 단순화합니다:

$$\text{VaR}_{95\%} \approx W \times 1.645 \times \sigma \times \sqrt{T}$$

**포트폴리오 VaR (다중 자산)**:

$$\sigma_p = \sqrt{\mathbf{w}^T \Sigma \mathbf{w}}$$

여기서 $\mathbf{w}$는 자산 비중 벡터, $\Sigma$는 공분산 행렬입니다.

$$\text{VaR}_p = W \times z_\alpha \times \sigma_p \times \sqrt{T}$$

**2자산 포트폴리오 예시**:

- 자산 A: 비중 60%, 일일 표준편차 1.5%
- 자산 B: 비중 40%, 일일 표준편차 2.0%
- 상관계수: 0.3

$$\sigma_p = \sqrt{0.6^2 \times 0.015^2 + 0.4^2 \times 0.02^2 + 2 \times 0.6 \times 0.4 \times 0.015 \times 0.02 \times 0.3}$$

$$\sigma_p = \sqrt{0.000081 + 0.000064 + 0.0000432} = \sqrt{0.0001882} \approx 1.372\%$$

분산 효과로 인해 포트폴리오 변동성(1.372%)이 개별 자산의 가중 평균 변동성(1.7%)보다 낮습니다.

### 방법론 3: 몬테카를로 시뮬레이션

확률 과정을 설정하고 난수를 발생시켜 대량의 시나리오를 생성한 후 VaR를 산출합니다.

**기하 브라운 운동(GBM) 기반 시뮬레이션**:

$$S_{t+\Delta t} = S_t \times \exp\left[(\mu - \frac{\sigma^2}{2})\Delta t + \sigma \sqrt{\Delta t} \times \epsilon\right]$$

여기서 $\epsilon \sim N(0, 1)$입니다.

**절차**:

1. 수익률의 확률 과정(GBM, GARCH, Jump-Diffusion 등)을 선택합니다
2. 모수($\mu$, $\sigma$, 상관계수 등)를 과거 데이터에서 추정합니다
3. 10,000~100,000개의 시나리오를 생성합니다
4. 각 시나리오별 포트폴리오 가치를 계산합니다
5. 손실 분포에서 해당 분위수를 VaR로 결정합니다

:::tip 개인투자자를 위한 몬테카를로 시뮬레이션
Python의 numpy와 scipy 라이브러리를 활용하면 비교적 간단하게 몬테카를로 VaR를 산출할 수 있습니다. 10,000회 시뮬레이션 기준 일반 PC에서 수 초 내에 결과를 얻을 수 있습니다.
:::

### VaR의 한계

| 한계점 | 설명 | 대안 |
|:------|:-----|:-----|
| 꼬리 리스크 과소평가 | VaR는 "경계값"만 제공, 꼬리 내부 정보 없음 | CVaR/ES 사용 |
| 비일관적 리스크 측도 | Sub-additivity 불만족 가능 | CVaR는 일관적 측도 |
| 정규분포 가정 (파라메트릭) | 실제 수익률은 팻테일 분포 | t-분포, 역사적 방법 |
| 과거 의존성 | 구조적 변화 반영 불가 | 스트레스 테스트 병행 |
| 단일 숫자의 한계 | 리스크의 다차원적 성격을 단일 값으로 축약 | 다중 지표 병행 |

---

## CVaR / Expected Shortfall (ES)

### 수학적 정의

CVaR(Conditional Value at Risk), 또는 Expected Shortfall(ES)은 VaR를 초과하는 손실의 조건부 기대값입니다.

$$\text{CVaR}_\alpha = E[L \mid L > \text{VaR}_\alpha]$$

연속 분포에서:

$$\text{CVaR}_\alpha = \frac{1}{1 - \alpha} \int_{\alpha}^{1} \text{VaR}_u \, du$$

정규분포를 가정할 경우 CVaR은 닫힌 형태로 표현됩니다:

$$\text{CVaR}_\alpha = \mu + \sigma \times \frac{\phi(z_\alpha)}{1 - \alpha}$$

여기서 $\phi$는 표준정규분포의 확률밀도함수(PDF)입니다.

### VaR vs CVaR 비교 예시

| 구분 | 95% VaR | 95% CVaR | 해석 |
|:-----|:--------|:---------|:-----|
| 포트폴리오 A | -300만 원 | -450만 원 | 꼬리 비교적 얇음 |
| 포트폴리오 B | -300만 원 | -800만 원 | 꼬리 매우 두꺼움 |

포트폴리오 A와 B의 VaR은 동일하지만, CVaR은 크게 다릅니다. B는 "나쁜 날"이 오면 훨씬 큰 손실을 입을 수 있다는 뜻입니다. VaR만 보면 두 포트폴리오의 리스크가 같아 보이지만, CVaR은 숨겨진 꼬리 리스크를 드러냅니다.

:::caution 바젤 III에서 CVaR 채택
바젤 위원회는 2016년부터 시장 리스크 자본 산출에 VaR 대신 Expected Shortfall(97.5% 신뢰수준)을 사용하도록 규정했습니다(FRTB: Fundamental Review of the Trading Book). 이는 CVaR이 VaR보다 더 보수적이고 일관적인 리스크 측도라는 학계와 실무의 공감대를 반영합니다.
:::

---

## Maximum Drawdown (최대낙폭)

### 수학적 정의

최대낙폭(MDD)은 특정 기간 내 자산 가치의 고점(peak)에서 저점(trough)까지의 최대 하락률입니다.

$$\text{MDD} = \max_{t \in [0, T]} \left( \frac{\max_{s \in [0, t]} P_s - P_t}{\max_{s \in [0, t]} P_s} \right)$$

여기서 $P_t$는 시점 $t$에서의 포트폴리오 가치입니다.

### MDD 관련 지표

| 지표 | 정의 | 활용 |
|:-----|:-----|:-----|
| Maximum Drawdown (MDD) | 최대 고점-저점 하락률 | 최악의 경험 측정 |
| Average Drawdown | 모든 드로다운의 평균 | 일상적 하락 수준 |
| Drawdown Duration | 고점 회복까지 소요 기간 | 인내의 시간 측정 |
| Calmar Ratio | 연환산 수익률 / MDD | 리스크 대비 수익 |
| Ulcer Index | 드로다운의 제곱 평균의 제곱근 | 드로다운의 깊이와 지속 기간 통합 |

### Ulcer Index 계산

울서 지수(Ulcer Index)는 드로다운의 깊이와 지속 기간을 모두 반영하는 지표입니다.

$$\text{UI} = \sqrt{\frac{1}{N} \sum_{i=1}^{N} D_i^2}$$

여기서 $D_i$는 시점 $i$에서의 드로다운(%)입니다. 표준편차가 상방/하방 변동성을 모두 포함하는 반면, Ulcer Index는 하방 변동성만을 측정합니다.

---

## 변동성 측정 방법

### 역사적 변동성 (Historical Volatility)

과거 수익률의 표준편차로 측정합니다.

$$\sigma = \sqrt{\frac{1}{N-1} \sum_{i=1}^{N} (r_i - \bar{r})^2}$$

연환산: $\sigma_{\text{annual}} = \sigma_{\text{daily}} \times \sqrt{252}$

| 측정 기간 | 특성 | 적합한 용도 |
|:---------|:-----|:-----------|
| 5일 | 극단적 단기, 노이즈 많음 | 일중 트레이딩 |
| 20일 (1개월) | 단기 변동성, 민감도 높음 | 단기 매매, 옵션 |
| 60일 (3개월) | 중기 변동성 | 스윙 트레이딩, VaR |
| 252일 (1년) | 장기 변동성, 안정적 | 자산배분, 장기 분석 |

### EWMA (지수가중이동평균) 변동성

최근 데이터에 더 높은 가중치를 부여하는 방법입니다. J.P. Morgan의 RiskMetrics에서 제안했습니다.

$$\sigma_t^2 = \lambda \sigma_{t-1}^2 + (1 - \lambda) r_{t-1}^2$$

여기서 $\lambda$는 감쇠 계수(decay factor)로 RiskMetrics에서는 일일 데이터에 0.94를 권장합니다.

### GARCH(1,1) 모형

변동성의 시간 가변성(time-varying volatility)과 클러스터링을 모형화합니다.

$$\sigma_t^2 = \omega + \alpha r_{t-1}^2 + \beta \sigma_{t-1}^2$$

여기서 $\omega > 0$, $\alpha \geq 0$, $\beta \geq 0$, $\alpha + \beta < 1$ (정상성 조건)

GARCH 모형은 "변동성이 높은 시기 다음에는 변동성이 높은 시기가 지속된다"는 변동성 클러스터링 현상을 포착합니다.

### 내재 변동성 (Implied Volatility)

옵션 시장 가격에 내재된 변동성입니다. Black-Scholes 모형에 시장 가격을 대입하여 역산합니다.

- **KOSPI 200 옵션의 IV**: 한국 시장의 공포/탐욕 지수 역할
- **V-KOSPI**: KOSPI 200 옵션의 내재 변동성 지수 (미국의 VIX에 해당)

| 변동성 수준 | V-KOSPI 범위 | 시장 상태 |
|:-----------|:------------|:---------|
| 매우 낮음 | 10~15 | 극단적 안정/자만 |
| 낮음 | 15~20 | 정상적 안정 |
| 보통 | 20~25 | 약간의 불안 |
| 높음 | 25~35 | 공포, 조정 |
| 매우 높음 | 35 이상 | 패닉, 위기 |

:::tip 내재 변동성의 활용
내재 변동성은 "시장 참여자들이 예상하는 미래 변동성"입니다. 역사적 변동성이 과거를 반영한다면, 내재 변동성은 미래에 대한 시장의 기대를 반영합니다. 내재 변동성이 역사적 변동성보다 높다면, 시장이 향후 변동성 확대를 예상한다는 의미입니다.
:::

---

## 베타 (Beta)

### 정의와 계산

베타는 시장 수익률 변동에 대한 개별 자산의 민감도를 측정합니다.

$$\beta_i = \frac{\text{Cov}(R_i, R_m)}{\text{Var}(R_m)} = \rho_{i,m} \times \frac{\sigma_i}{\sigma_m}$$

여기서 $R_i$는 개별 자산 수익률, $R_m$은 시장 수익률입니다.

| 베타 값 | 의미 | 예시 |
|:--------|:-----|:-----|
| $\beta > 1.5$ | 시장보다 훨씬 민감 (고위험) | 바이오, 소형 성장주 |
| $\beta = 1.0$ | 시장과 동일한 변동 | 시장 인덱스 |
| $0.5 < \beta < 1.0$ | 시장보다 덜 민감 (방어적) | 유틸리티, 필수소비재 |
| $\beta \approx 0$ | 시장과 무관 | 절대수익 전략 |
| $\beta < 0$ | 시장과 반대 방향 | 인버스 ETF, 금(일부 기간) |

### 베타의 한계

- 베타는 과거 데이터 기반이므로 미래 베타와 다를 수 있습니다
- 비선형 관계(옵션성 포지션 등)를 포착하지 못합니다
- 비정상적 시장(위기 시)에서 베타가 급격히 변할 수 있습니다
- 측정 기간과 빈도에 따라 값이 달라집니다

---

## 추적오차 (Tracking Error)

### 정의

추적오차는 포트폴리오 수익률과 벤치마크 수익률 차이(초과수익률)의 표준편차입니다.

$$\text{TE} = \sigma(R_p - R_b) = \sqrt{\frac{1}{N-1} \sum_{i=1}^{N} (e_i - \bar{e})^2}$$

여기서 $e_i = R_{p,i} - R_{b,i}$는 초과수익률입니다.

| 추적오차 수준 | 의미 | 운용 스타일 |
|:-------------|:-----|:-----------|
| 0~1% | 벤치마크와 거의 동일 | 패시브/인덱스 운용 |
| 1~3% | 소폭 벤치마크 이탈 | 인핸스드 인덱스 |
| 3~6% | 적극적 액티브 운용 | 일반 액티브 펀드 |
| 6~10% | 고도의 액티브 운용 | 집중 투자 펀드 |
| 10% 이상 | 벤치마크와 크게 괴리 | 절대수익 추구 |

---

## 리스크 지표 종합 비교

| 지표 | 측정 대상 | 장점 | 단점 | 개인투자자 활용도 |
|:-----|:---------|:-----|:-----|:----------------|
| VaR | 최대 예상 손실 | 직관적, 금액 단위 | 꼬리 무시, 단일 값 | 높음 |
| CVaR/ES | 꼬리 손실 평균 | 꼬리 리스크 포착 | 계산 복잡 | 보통 |
| MDD | 최대 하락폭 | 실제 경험 반영 | 후행적, 단일 사건 | 매우 높음 |
| 표준편차 | 전체 변동성 | 계산 용이, 보편적 | 상하방 동일 취급 | 높음 |
| 하방편차 | 하방 변동성만 | 투자자 관점 적합 | 데이터 절반만 사용 | 보통 |
| 베타 | 시장 민감도 | CAPM과 연계 | 비선형 무시, 비안정적 | 높음 |
| 추적오차 | 벤치마크 이탈 | 상대 성과 평가 | 벤치마크 의존 | 보통 |

:::danger 단일 지표의 위험성
어떤 단일 리스크 지표도 포트폴리오의 전체 리스크를 완벽하게 포착할 수 없습니다. VaR가 낮다고 안전한 것이 아니며, MDD가 작았다고 미래에도 작을 것이라는 보장이 없습니다. 항상 여러 지표를 병행하여 다각도에서 리스크를 평가해야 합니다.
:::

---

## 실전 적용: 개인투자자를 위한 리스크 모니터링

### 주간 리스크 점검표

1. **포트폴리오 변동성**: 최근 20일 일일 수익률의 표준편차를 연환산합니다
2. **현재 드로다운**: 고점 대비 현재 하락률을 확인합니다
3. **개별 종목 베타**: 포트폴리오의 가중 평균 베타를 계산합니다
4. **VaR 점검**: 역사적 시뮬레이션으로 95% 1일 VaR를 추정합니다
5. **V-KOSPI 수준**: 시장 전체의 공포 수준을 확인합니다

### 엑셀로 간단한 VaR 계산

1. 보유 종목의 과거 250일 종가 데이터를 다운로드합니다
2. 일일 수익률을 계산합니다: $r_i = \ln(P_i / P_{i-1})$
3. 수익률을 정렬하여 하위 5%를 확인합니다 (역사적 VaR)
4. STDEV 함수로 표준편차를 구하고 $\times 1.645$로 파라메트릭 VaR를 계산합니다
5. 두 방법의 결과를 비교합니다

---

## 참고 문헌

- Jorion, Philippe, *Value at Risk*, McGraw-Hill, 3rd ed., 2006
- RiskMetrics Group, *RiskMetrics Technical Document*, J.P. Morgan, 1996
- Artzner et al., "Coherent Measures of Risk", *Mathematical Finance*, 1999
- Basel Committee on Banking Supervision, "Minimum capital requirements for market risk", BIS, 2019

## 관련 페이지

- [리스크 관리 개요](./overview) -- 리스크의 유형과 관리 원칙
- [포지션 사이징](./position-sizing) -- VaR를 활용한 포지션 크기 결정
- [포트폴리오 구성](./portfolio-construction) -- 분산투자를 통한 리스크 관리
- [드로다운 관리](./drawdown-management) -- MDD 기반 포트폴리오 관리
- [위험조정수익률](./risk-adjusted-returns) -- 리스크 지표를 활용한 성과 평가
- [스트레스 테스트](./stress-testing) -- VaR를 보완하는 극단 시나리오 분석
- [상관관계 & 분산투자](./correlation-diversification) -- 포트폴리오 VaR의 핵심 입력값
